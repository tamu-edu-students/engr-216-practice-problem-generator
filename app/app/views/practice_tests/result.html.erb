<h1>Test Results</h1>

<h2>Your Score: <%= @score %> / <%= @total %></h2>

<% if @results.present? %>
  <% @results.each_with_index do |res, index| %>
    <div class="result-question" style="margin-bottom: 20px;">
      <h3>Question <%= index + 1 %>:</h3>

      <% if res[:question_img].present? %>
        <div class="problem-image">
          <img src="<%= res[:question_img] %>" alt="Problem Image" style="max-width: 100%; height: auto;">
        </div>
      <% end %>

      <p><strong>Question:</strong> <%= res[:question_text].to_s.presence || '[No question text]' %></p>

      <p style="color: <%= res[:correct] ? 'green' : 'red' %>;">
        <strong><%= res[:correct] ? "Correct" : "Incorrect" %></strong>
      </p>

      <p><strong>Your Answer:</strong> <%= res[:submitted_answer].to_s.presence || '[No answer provided]' %></p>
      <p><strong>Correct Answer:</strong> <%= res[:solution].to_s.presence || '[No solution available]' %></p>
    </div>
    <hr>
  <% end %>
<% else %>
  <p>No results to display. You may not have taken the test yet.</p>
<% end %>

<%= link_to "Take Another Exam", practice_test_generation_path, class: "btn btn-primary", style: "margin-top: 20px;" %>